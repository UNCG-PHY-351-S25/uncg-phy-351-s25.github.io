<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Factor Out Subfunctions - PHY 351 Reference</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../../css/custom.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">PHY 351 Reference</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Course Admin</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../admin/syllabus/" class="dropdown-item">Syllabus</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Recipes</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../" class="dropdown-item">Intro to Recipes</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">A) Core Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../" class="dropdown-item">Overview</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Workflow</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../workflow/" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../../workflow/find-and-fork/" class="dropdown-item">Find and Fork a Repo on GitHub</a>
</li>
            
<li>
    <a href="../../workflow/manage-files/" class="dropdown-item">Manage Files on Beskar</a>
</li>
            
<li>
    <a href="../../workflow/github-auth/" class="dropdown-item">Authorizing with GitHub from Beskar</a>
</li>
            
<li>
    <a href="../../workflow/clone-to-beskar/" class="dropdown-item">Clone a Repo to Beskar</a>
</li>
            
<li>
    <a href="../../workflow/commit-push/" class="dropdown-item">Commit and Push Changes to GitHub</a>
</li>
            
<li>
    <a href="../../workflow/interactive-python/" class="dropdown-item">Execute Interactive Python</a>
</li>
            
<li>
    <a href="../../workflow/submit-level/" class="dropdown-item">Submit a Level</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Calculation</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../calculation/" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../../calculation/calc-interactively/" class="dropdown-item">Calculate Interactively</a>
</li>
            
<li>
    <a href="../../calculation/use-functions/" class="dropdown-item">Use Python Functions</a>
</li>
            
<li>
    <a href="../../calculation/complex-numbers/" class="dropdown-item">Use Complex Numbers</a>
</li>
            
<li>
    <a href="../../calculation/print/" class="dropdown-item">Print Formatted Output</a>
</li>
            
<li>
    <a href="../../calculation/scripts/" class="dropdown-item">Script a Calculation</a>
</li>
            
<li>
    <a href="../../calculation/user-input/" class="dropdown-item">Ask for User Input</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Functions</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../writing-functions/" class="dropdown-item">Write Your Own Function</a>
</li>
            
<li>
    <a href="../optional-args/" class="dropdown-item">Make Arguments Optional</a>
</li>
            
<li>
    <a href="../conditionals/" class="dropdown-item">Execute Code Conditionally</a>
</li>
            
<li>
    <a href="../safety-check/" class="dropdown-item">Safety-Check Arguments</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Factor Out Subfunctions</a>
</li>
            
<li>
    <a href="../globals/" class="dropdown-item">Use Global Variables (Sparingly!)</a>
</li>
            
<li>
    <a href="../run-or-import/" class="dropdown-item">Run or Import From a Script</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Iteration</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../iteration/" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../../iteration/for/" class="dropdown-item">Repeat Code a Specific Number of Times</a>
</li>
            
<li>
    <a href="../../iteration/while/" class="dropdown-item">Repeat While or Until Something Is True</a>
</li>
            
<li>
    <a href="../../iteration/break/" class="dropdown-item">Stop Iteration Early</a>
</li>
            
<li>
    <a href="../../iteration/pick/" class="dropdown-item">Flip a Coin or Roll a Die</a>
</li>
            
<li>
    <a href="../../iteration/stats/" class="dropdown-item">Determine Statistics of a Sequence</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Collections</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../collections/" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../../collections/tuples/" class="dropdown-item">Group Related Values Into Tuples</a>
</li>
            
<li>
    <a href="../../collections/lists/" class="dropdown-item">Manage Sequences of Values with Lists</a>
</li>
            
<li>
    <a href="../../collections/sets/" class="dropdown-item">Identify Unique &amp; Shared Elements with Sets</a>
</li>
            
<li>
    <a href="../../collections/dicts/" class="dropdown-item">Organize Labeled Collections with Dictionaries</a>
</li>
            
<li>
    <a href="../../collections/iterate-pythonically/" class="dropdown-item">Iterate Pythonically</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">B) Numerical Methods 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../num1/" class="dropdown-item">Overview</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Randomness</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../num1/random/" class="dropdown-item">(Recipe List)</a>
</li>
            
<li>
    <a href="../../../num1/random/integers/" class="dropdown-item">Generate Random Integers</a>
</li>
            
<li>
    <a href="../../../num1/random/choices/" class="dropdown-item">Pick Randomly From a Set of Options</a>
</li>
            
<li>
    <a href="../../../num1/random/sampling/" class="dropdown-item">Shuffle and/or Sample From a Set</a>
</li>
            
<li>
    <a href="../../../num1/random/reals/" class="dropdown-item">Generate Random Real Numbers</a>
</li>
            
<li>
    <a href="../../../num1/random/distributions/" class="dropdown-item">Draw From a Weighted Distribution</a>
</li>
            
<li>
    <a href="../../../num1/random/seeding/" class="dropdown-item">Reproduce "Random" Results</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../../roots" class="dropdown-item">Roots</a>
</li>
            
<li>
    <a href="../../../../extrema" class="dropdown-item">Extrema</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">C) Scientific Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../scipy/" class="dropdown-item">Skillset B: Scientific Python</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">D) Numerical Methods 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../num2/" class="dropdown-item">Numerical Methods 2: Numerical Calculus</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">E) Visual Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../visual/" class="dropdown-item">Skillset C: Visual Python</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Topics</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../topics/" class="dropdown-item">Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Setup Guide</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../topics/setup/" class="dropdown-item">Overview</a>
</li>
            
<li>
    <a href="../../../../topics/setup/github-account/" class="dropdown-item">Creating your GitHub Account</a>
</li>
            
<li>
    <a href="../../../../topics/setup/beskar-account/" class="dropdown-item">Creating your Beskar Account</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../../topics/external/" class="dropdown-item">External Tutorials</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Core Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../topics/core/operators/" class="dropdown-item">Arithmetic Operators</a>
</li>
            
<li>
    <a href="../../../../topics/core/precedence/" class="dropdown-item">Operator Precedence</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Scientific Python</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../topics/scipy/numpy/" class="dropdown-item">Introduction to Numpy</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../safety-check/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../globals/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/UNCG-PHY-351-S25.github.io/edit/master/docs/recipes/core/functions/factoring.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                            <li class="nav-item dropdown">
                              <button id="theme-menu" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme" class="nav-link dropdown-toggle">
                                <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                <span class="d-lg-none ms-2">Toggle theme</span>
                              </button>
                              <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="true">
                                    <i class="fa-solid fa-sun fa-fw"></i>
                                    <span class="ms-2">Light</span>
                                    <i class="fa-solid fa-check ms-auto"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                                    <i class="fa-solid fa-moon fa-fw"></i>
                                    <span class="ms-2">Dark</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="auto" aria-pressed="false">
                                    <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                    <span class="ms-2">Auto</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                              </ul>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
        <script src="../../../../js/darkmode.js"></script>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#factor-out-subfunctions" class="nav-link">Factor Out Subfunctions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#problem-to-solve" class="nav-link">Problem to Solve</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#recipe" class="nav-link">Recipe</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#example" class="nav-link">Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="factor-out-subfunctions">Factor Out Subfunctions</h1>
<hr />
<h2 id="problem-to-solve">Problem to Solve</h2>
<blockquote>
<p><strong>I want to break a complicated calculation into pieces to keep it manageable.</strong></p>
</blockquote>
<p>You will find, as you write more complicated code — multi-step calculations, multi-body physics simulations, etc. — that most of the work is done inside functions you define. For example, in a Visual Python simulation of interacting objects, you may have a function <code>update_scene()</code> whose job is to move all the 3D objects to new locations. That function will have to calculate all the interaction and constraint forces, determine the resulting accelerations of all the objects, determine how their velocities and positions change, and then give the commands to actually modify the scene.</p>
<p>If you try to put all the code for this into the one function, it will become painfully long and hard to work with. The smart approach is to <strong><em>factor</em></strong> it into multiple small, mostly-independent calculations, and to put each one in its own function. Functionality that is factored out of one function and put into another is called a <strong><em>subfunction</em></strong>.</p>
<hr />
<h2 id="recipe">Recipe</h2>
<p>Here's the general pattern:</p>
<pre><code class="language-python">def subfunction_1(arg1, ...):
    &quot;&quot;&quot; Encapsulates one bit of functionality. &quot;&quot;&quot;
    result = ... # Calculate something using one or more lines of code
    return result

def subfunction_2(arg1, arg2, ...):
    &quot;&quot;&quot; Encapsulates a different bit of functionality. &quot;&quot;&quot;
    other_result = ... # Calculate something using one or more lines of code
    return other_result

def main_function(arg_A, arg_B, ...):
    &quot;&quot;&quot; Does something complicated. &quot;&quot;&quot;
    x = ... # Calculation
    z = subfunction_1(x, arg_B, ...)
    q = subfunction_2(z, ...)
    end_result = ... # Calculation
    return end_result
</code></pre>
<p>Hopefully it's obvious that you can give the functions, arguments, and variables any names that reflect their actual purposes and meanings.</p>
<p>It's entirely possible to call the same subfunction multiple times from the same main function, or even from different other functions. (A function can even call itself… That's called <em>recursion</em>, and can be a powerful technique, but be careful that it doesn't go on forever.)</p>
<h3 id="when-should-you-factor-code-into-a-subfunction">When should you factor code into a subfunction?</h3>
<p>That's a judgment call. When considering whether to factor a particular chunk of code into a subfunction, ask yourself:</p>
<ul>
<li>Is this chunk of code doing something with one purpose, which could be described as the purpose of the possible subfunction?</li>
<li>Is this chunk of code connected to the surrounding code fairly loosely, so that all it would need are a few input arguments and a return value or two? Or does it use and/or change multiple variables from the code around it in ways that are hard to cleanly factor?</li>
<li>Is it long enough to be worth factoring?</li>
<li>Overall, would moving this bit out make the code easier or harder to understand and debug?</li>
</ul>
<p>Sometimes it's worth putting a single line of code into a subfunction, if the line is nontrivial and doing so improves code readability. The ability to give that chunk a descriptive name (it's function name) can, all by itself, significantly aid readability.</p>
<p>BTW, one very significant advantage of factoring code into subfunctions is that you can test the subfunctions individually to make sure they work correctly. Finding a head-scratcher of a bug is much easier if you've narrowed it down to somewhere in a five-line function than if it's somewhere in a 40-line function.</p>
<hr />
<h2 id="example">Example</h2>
<p>Let's say we need to calculate the total electrostatic potential energy stored in an arrangement of three charged point particles. Doing that requires summing the three pairwise potential energies, so calculating the potential energy of a pair is a sensible subfunction. Also, doing each pair calculation requires finding a distance, which <em>could</em> be done inline, but could also be factored out for clarity.</p>
<pre><code class="language-python">from math import sqrt

def distance(x1, y1, z1, x2, y2, z2):
    &quot;&quot;&quot; Returns the distance between two points in 3D.
    &quot;&quot;&quot;
    return sqrt((x1-x2)**2 + (y1-y2)**2 + (z1-z2)**2)

def two_body_potential(q1, x1, y1, z1, q2, x2, y2, z2):
    &quot;&quot;&quot; Returns the potential energy of two point charges, in SI 
        units.
    &quot;&quot;&quot;
    k = 8.9875517873681764e9 # N m² C⁻²
    r = distance(x1, y1, z1, x2, y2, z2)
    return k * q1 * q2 / r

def three_body potential(q1, x1, y1, z1, q2, x2, y2, z2, q3, x3, y3, z3):
    &quot;&quot;&quot; Returns the total potential energy of three point charges, in SI 
        units.
    &quot;&quot;&quot;
    return (two_body_potential(q1, x1, y1, z1, q2, x2, y2, z2) +
            two_body_potential(q1, x1, y1, z1, q3, x3, y3, z3) +
            two_body_potential(q2, x2, y2, z2, q3, x3, y3, z3))
</code></pre>
<p>Side note: The most awkward part of all this is passing around four arguments for every particle. I wouldn't actually do this; instead, I'd pack them together into <em>tuples</em> or <em>lists</em> or — getting fancy — something called a <em>named tuple</em>. We'll be covering <em>tuples</em> and <em>lists</em> in Level A-05. After doing that, if you want to teach yourself about named tuples, <a href="https://realpython.com/python-namedtuple/" target="_blank">be my guest!</a></p>
<hr /></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js"></script>
        <script src="../../../../javascripts/mathjax.js"></script>
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
